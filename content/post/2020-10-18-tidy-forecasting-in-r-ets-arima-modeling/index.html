---
title: 'Tidy Forecasting in R: ETS & ARIMA Modeling'
author: Joon Im
date: '2020-10-18'
slug: tidy-forecasting-in-r-ets-arima-modeling
categories:
  - Forecasting
  - R
  - Time Series
tags:
  - fable
  - forecast
  - fpp2
  - fpp3
  - modeltime
  - R
  - time Series
  - tidyverse
---



<div id="set-up" class="section level1">
<h1>1. Set Up</h1>
<div id="introduction" class="section level3">
<h3>1.1 Introduction</h3>
<p>This article is the second in a series comparing the <code>fpp2</code>, <code>fpp3</code>, and <code>modeltime</code> forecasting frameworks in <code>R</code>. Specifically weâ€™ll be focusing on how to automatically choose both exponential smoothing and ARIMA models.</p>
</div>
<div id="load-libraries" class="section level3">
<h3>1.2 Load Libraries</h3>
<pre class="r"><code># Load libraries
library(fpp2)         # The forecasting OG
library(fpp3)         # Official update to fpp2
library(modeltime)    # The forecasting newcomer
library(timetk)       # Companion to modeltime
library(parsnip)      # Common interface for specifying models
library(tidyverse)    # Data manipulation tools
library(cowplot)      # Arranging plots</code></pre>
</div>
<div id="about-exponentially-weighted-models" class="section level3">
<h3>1.3 About Exponentially Weighted Models</h3>
<ul>
<li>A family of models where the <strong>trend</strong> component is either <em>missing</em>, <em>additive</em> or <em>damped</em> and the <strong>seasonal</strong> component is either <em>missing</em>, <em>additive</em>, or <em>multiplicative</em></li>
<li>Forecasts are weighted averages of past observations i.e.Â the more recent an observation, the higher the associated weight</li>
</ul>
<blockquote>
<p>ETS model forecasts can be quickly generated and generalize well to many different types of time series</p>
</blockquote>
</div>
<div id="about-autoregressive-integrated-moving-average-models" class="section level3">
<h3>1.4 About AutoRegressive Integrated Moving Average Models</h3>
<ul>
<li>A family of models where:
<ul>
<li><strong>AR</strong>: variable of interest undergoes a regression against prior values</li>
<li><strong>I</strong>: variable of interest undergoes a normalizing transformation called <em>differencing</em> for better model fitting</li>
<li><strong>MA</strong>: variable of interest undergoes a regression against prior residual errors</li>
</ul></li>
<li>Forecasts are based on the idea that models can find patterns from past values which are then applied to future values</li>
</ul>
</div>
</div>
<div id="an-overview-of-exponential-smoothing-models" class="section level1">
<h1>2. An Overview of Exponential Smoothing Models</h1>
<p>The following examples will utilize a dataset containing yearly winning times of the Boston marathon.</p>
<pre class="r"><code># Load Boston marathon winning times 
m_tbl &lt;- fpp2::marathon %&gt;%
  tk_tbl(rename_index = &quot;year&quot;) %&gt;%
  mutate(year = ymd(year, truncated = 2L))

# Check it out
m_tbl %&gt;% head()
## # A tibble: 6 x 2
##   year       value
##   &lt;date&gt;     &lt;dbl&gt;
## 1 1897-01-01  175.
## 2 1898-01-01  162 
## 3 1899-01-01  175.
## 4 1900-01-01  160.
## 5 1901-01-01  149.
## 6 1902-01-01  163.</code></pre>
<div id="simple-exponential-smoothing" class="section level3">
<h3>2.1 Simple Exponential Smoothing</h3>
<ul>
<li>The forecasts are simply the last value of the estimated level</li>
<li>The level changes over time as a function of the most recent observation</li>
</ul>
<pre class="r"><code># Convert to tsibble
m_tsbl &lt;- fpp2::marathon %&gt;% as_tsibble()

# Fit a SES model: additive errors, no trend, no seasonality
fit &lt;- m_tsbl %&gt;%
  model(ets = ETS(value ~ error(&quot;A&quot;) + trend(&quot;N&quot;) + season(&quot;N&quot;)))

# Forecast for 10 years into the future
fc &lt;- fit %&gt;% forecast(h = 10)

# Plot forecasts + one-step forecasts for the training data
fc %&gt;%
  autoplot(m_tsbl) +   # Plot actual data 
  geom_line(aes(y = .fitted, colour = &quot;Fitted&quot;),  
            data = augment(fit)) +  # Show how model fits the data
  labs(title=&quot;Boston marathon winning times with 10-year SES forecast&quot;,
       x=&quot;&quot;, y=&quot;Minutes&quot;) </code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<blockquote>
<p>ðŸ’¡ If your data has no trend and no seasonality, then an SES model may work well.</p>
</blockquote>
</div>
<div id="holts-linear-method" class="section level3">
<h3>2.2 Holtâ€™s Linear Method</h3>
<ul>
<li>Holtâ€™s linear method extends SES by adding trend</li>
<li>The forecast equation is a linear function of the forecast horizon where forecasts are the last value of the estimated level</li>
<li>The level also changes over time as a function of the most recent observation with added trend</li>
</ul>
</div>
</div>
